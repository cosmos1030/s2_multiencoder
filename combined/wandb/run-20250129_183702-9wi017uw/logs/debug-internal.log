2025-01-29 18:37:02,579 INFO    StreamThr :319 [internal.py:wandb_internal():86] W&B internal server running at pid: 319, started at: 2025-01-29 18:37:02.578957
2025-01-29 18:37:02,581 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: status
2025-01-29 18:37:02,586 INFO    WriterThread:319 [datastore.py:open_for_write():85] open: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/run-9wi017uw.wandb
2025-01-29 18:37:02,592 DEBUG   SenderThread:319 [sender.py:send():379] send: header
2025-01-29 18:37:02,592 DEBUG   SenderThread:319 [sender.py:send():379] send: run
2025-01-29 18:37:02,925 INFO    SenderThread:319 [dir_watcher.py:__init__():211] watching files in: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files
2025-01-29 18:37:02,925 INFO    SenderThread:319 [sender.py:_start_run_threads():1121] run started: 9wi017uw with start time 1738175822.581371
2025-01-29 18:37:02,930 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: check_version
2025-01-29 18:37:02,930 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: check_version
2025-01-29 18:37:03,116 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: run_start
2025-01-29 18:37:03,128 DEBUG   HandlerThread:319 [system_info.py:__init__():32] System info init
2025-01-29 18:37:03,128 DEBUG   HandlerThread:319 [system_info.py:__init__():47] System info init done
2025-01-29 18:37:03,128 INFO    HandlerThread:319 [system_monitor.py:start():181] Starting system monitor
2025-01-29 18:37:03,128 INFO    SystemMonitor:319 [system_monitor.py:_start():145] Starting system asset monitoring threads
2025-01-29 18:37:03,129 INFO    HandlerThread:319 [system_monitor.py:probe():201] Collecting system info
2025-01-29 18:37:03,130 INFO    SystemMonitor:319 [interfaces.py:start():190] Started cpu monitoring
2025-01-29 18:37:03,131 INFO    SystemMonitor:319 [interfaces.py:start():190] Started disk monitoring
2025-01-29 18:37:03,132 INFO    SystemMonitor:319 [interfaces.py:start():190] Started gpu monitoring
2025-01-29 18:37:03,133 INFO    SystemMonitor:319 [interfaces.py:start():190] Started memory monitoring
2025-01-29 18:37:03,137 INFO    SystemMonitor:319 [interfaces.py:start():190] Started network monitoring
2025-01-29 18:37:03,145 DEBUG   HandlerThread:319 [system_info.py:probe():196] Probing system
2025-01-29 18:37:03,148 DEBUG   HandlerThread:319 [system_info.py:_probe_git():181] Probing git
2025-01-29 18:37:03,156 DEBUG   HandlerThread:319 [system_info.py:_probe_git():189] Probing git done
2025-01-29 18:37:03,156 DEBUG   HandlerThread:319 [system_info.py:probe():244] Probing system done
2025-01-29 18:37:03,156 DEBUG   HandlerThread:319 [system_monitor.py:probe():210] {'os': 'Linux-5.19.0-45-generic-x86_64-with-glibc2.35', 'python': '3.11.7', 'heartbeatAt': '2025-01-29T18:37:03.145641', 'startedAt': '2025-01-29T18:37:02.559186', 'docker': None, 'cuda': None, 'args': ('--mode', 'train', '--batch_size', '256', '--epochs', '10', '--lr', '1e-3', '--train_dirs', '/datasets/external/imagenet100/train.X1', '/datasets/external/imagenet100/train.X2', '/datasets/external/imagenet100/train.X3', '/datasets/external/imagenet100/train.X4', '--test_dir', '/datasets/external/imagenet100/imagenet100/val.X', '--labels_path', '/datasets/external/imagenet100/Labels.json', '--clip_model_name', '', '--dino_model_name', 'facebook/dinov2-base', '--checkpoint_dir', '/datasets/external/s2_multiencoder/checkpoints/line/checkpoints', '--resume_checkpoint', '/datasets/external/s2_multiencoder/checkpoints/linear_probing_multi_s2/checkpoints/best_epoch_1.pth', '--project_name', 'my_earlystop_project'), 'state': 'running', 'program': '/notebooks/s2_multiencoder/combined/main.py', 'codePathLocal': 'main.py', 'codePath': 'combined/main.py', 'git': {'remote': 'https://github.com/cosmos1030/s2_multiencoder.git', 'commit': 'c8598b3048b8e788d0c99dfed301cd61c47a62e4'}, 'email': None, 'root': '/notebooks/s2_multiencoder', 'host': 'nq6yjmxpbf', 'username': 'root', 'executable': '/usr/local/bin/python', 'cpu_count': 8, 'cpu_count_logical': 8, 'cpu_freq': {'current': 2599.892, 'min': 0.0, 'max': 0.0}, 'cpu_freq_per_core': [{'current': 2599.892, 'min': 0.0, 'max': 0.0}, {'current': 2599.892, 'min': 0.0, 'max': 0.0}, {'current': 2599.892, 'min': 0.0, 'max': 0.0}, {'current': 2599.892, 'min': 0.0, 'max': 0.0}, {'current': 2599.892, 'min': 0.0, 'max': 0.0}, {'current': 2599.892, 'min': 0.0, 'max': 0.0}, {'current': 2599.892, 'min': 0.0, 'max': 0.0}, {'current': 2599.892, 'min': 0.0, 'max': 0.0}], 'disk': {'/': {'total': 244.23077011108398, 'used': 160.90696334838867}}, 'gpu': 'Quadro P5000', 'gpu_count': 1, 'gpu_devices': [{'name': 'Quadro P5000', 'memory_total': 17179869184}], 'memory': {'total': 29.3634033203125}}
2025-01-29 18:37:03,156 INFO    HandlerThread:319 [system_monitor.py:probe():211] Finished collecting system info
2025-01-29 18:37:03,156 INFO    HandlerThread:319 [system_monitor.py:probe():214] Publishing system info
2025-01-29 18:37:03,156 DEBUG   HandlerThread:319 [system_info.py:_save_pip():52] Saving list of pip packages installed into the current environment
2025-01-29 18:37:03,160 DEBUG   HandlerThread:319 [system_info.py:_save_pip():68] Saving pip packages done
2025-01-29 18:37:03,161 INFO    HandlerThread:319 [system_monitor.py:probe():216] Finished publishing system info
2025-01-29 18:37:03,167 DEBUG   SenderThread:319 [sender.py:send():379] send: files
2025-01-29 18:37:03,168 INFO    SenderThread:319 [sender.py:_save_file():1375] saving file wandb-metadata.json with policy now
2025-01-29 18:37:03,175 DEBUG   SenderThread:319 [sender.py:send():379] send: telemetry
2025-01-29 18:37:03,581 INFO    wandb-upload_0:319 [upload_job.py:push():131] Uploaded file /tmp/tmpmxnv0o8ewandb/n7oshv9b-wandb-metadata.json
2025-01-29 18:37:03,927 INFO    Thread-12 :319 [dir_watcher.py:_on_file_created():271] file/dir created: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/wandb-metadata.json
2025-01-29 18:37:03,928 INFO    Thread-12 :319 [dir_watcher.py:_on_file_created():271] file/dir created: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/requirements.txt
2025-01-29 18:37:07,850 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: internal_messages
2025-01-29 18:37:07,851 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: stop_status
2025-01-29 18:37:07,852 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: stop_status
2025-01-29 18:37:07,972 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: status_report
2025-01-29 18:37:10,938 INFO    Thread-12 :319 [dir_watcher.py:_on_file_created():271] file/dir created: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/output.log
2025-01-29 18:37:11,544 DEBUG   SenderThread:319 [sender.py:send():379] send: exit
2025-01-29 18:37:11,544 INFO    SenderThread:319 [sender.py:send_exit():584] handling exit code: 1
2025-01-29 18:37:11,544 INFO    SenderThread:319 [sender.py:send_exit():586] handling runtime: 8
2025-01-29 18:37:11,547 INFO    SenderThread:319 [sender.py:_save_file():1375] saving file wandb-summary.json with policy end
2025-01-29 18:37:11,547 INFO    SenderThread:319 [sender.py:send_exit():592] send defer
2025-01-29 18:37:11,547 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:11,547 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 0
2025-01-29 18:37:11,548 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:11,548 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 0
2025-01-29 18:37:11,548 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 1
2025-01-29 18:37:11,548 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:11,548 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 1
2025-01-29 18:37:11,548 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:11,548 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 1
2025-01-29 18:37:11,548 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 2
2025-01-29 18:37:11,549 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:11,549 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 2
2025-01-29 18:37:11,549 INFO    HandlerThread:319 [system_monitor.py:finish():190] Stopping system monitor
2025-01-29 18:37:11,549 DEBUG   SystemMonitor:319 [system_monitor.py:_start():159] Starting system metrics aggregation loop
2025-01-29 18:37:11,550 INFO    HandlerThread:319 [interfaces.py:finish():202] Joined cpu monitor
2025-01-29 18:37:11,550 DEBUG   SystemMonitor:319 [system_monitor.py:_start():166] Finished system metrics aggregation loop
2025-01-29 18:37:11,550 DEBUG   SystemMonitor:319 [system_monitor.py:_start():170] Publishing last batch of metrics
2025-01-29 18:37:11,550 INFO    HandlerThread:319 [interfaces.py:finish():202] Joined disk monitor
2025-01-29 18:37:11,560 INFO    HandlerThread:319 [interfaces.py:finish():202] Joined gpu monitor
2025-01-29 18:37:11,560 INFO    HandlerThread:319 [interfaces.py:finish():202] Joined memory monitor
2025-01-29 18:37:11,560 INFO    HandlerThread:319 [interfaces.py:finish():202] Joined network monitor
2025-01-29 18:37:11,561 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:11,561 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 2
2025-01-29 18:37:11,561 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 3
2025-01-29 18:37:11,561 DEBUG   SenderThread:319 [sender.py:send():379] send: stats
2025-01-29 18:37:11,562 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:11,562 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 3
2025-01-29 18:37:11,568 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:11,568 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 3
2025-01-29 18:37:11,568 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 4
2025-01-29 18:37:11,569 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:11,569 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 4
2025-01-29 18:37:11,569 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:11,570 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 4
2025-01-29 18:37:11,570 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 5
2025-01-29 18:37:11,570 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:11,570 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 5
2025-01-29 18:37:11,570 DEBUG   SenderThread:319 [sender.py:send():379] send: summary
2025-01-29 18:37:11,582 INFO    SenderThread:319 [sender.py:_save_file():1375] saving file wandb-summary.json with policy end
2025-01-29 18:37:11,582 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:11,582 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 5
2025-01-29 18:37:11,582 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 6
2025-01-29 18:37:11,582 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:11,582 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 6
2025-01-29 18:37:11,583 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:11,583 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 6
2025-01-29 18:37:11,586 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: status_report
2025-01-29 18:37:11,715 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 7
2025-01-29 18:37:11,715 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:11,716 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 7
2025-01-29 18:37:11,716 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:11,716 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 7
2025-01-29 18:37:11,939 INFO    Thread-12 :319 [dir_watcher.py:_on_file_modified():288] file/dir modified: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/config.yaml
2025-01-29 18:37:11,939 INFO    Thread-12 :319 [dir_watcher.py:_on_file_created():271] file/dir created: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/wandb-summary.json
2025-01-29 18:37:12,543 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: poll_exit
2025-01-29 18:37:12,939 INFO    Thread-12 :319 [dir_watcher.py:_on_file_modified():288] file/dir modified: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/output.log
2025-01-29 18:37:13,578 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 8
2025-01-29 18:37:13,578 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: poll_exit
2025-01-29 18:37:13,579 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:13,579 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 8
2025-01-29 18:37:13,580 DEBUG   SenderThread:319 [sender.py:send_request():406] send_request: defer
2025-01-29 18:37:13,580 INFO    SenderThread:319 [sender.py:send_request_defer():608] handle sender defer: 8
2025-01-29 18:37:13,580 INFO    SenderThread:319 [job_builder.py:build():281] Attempting to build job artifact
2025-01-29 18:37:13,580 INFO    SenderThread:319 [job_builder.py:_get_source_type():393] is repo sourced job
2025-01-29 18:37:13,581 INFO    SenderThread:319 [job_builder.py:build():369] adding wandb-job metadata file
2025-01-29 18:37:13,586 INFO    SenderThread:319 [sender.py:transition_state():612] send defer: 9
2025-01-29 18:37:13,587 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: defer
2025-01-29 18:37:13,587 INFO    HandlerThread:319 [handler.py:handle_request_defer():170] handle defer: 9
2025-01-29 18:37:13,587 DEBUG   SenderThread:319 [sender.py:send():379] send: artifact
2025-01-29 18:37:13,940 INFO    Thread-12 :319 [dir_watcher.py:_on_file_modified():288] file/dir modified: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/output.log
2025-01-29 18:37:17,544 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: keepalive
2025-01-29 18:37:22,547 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: keepalive
2025-01-29 18:37:27,548 DEBUG   HandlerThread:319 [handler.py:handle_request():144] handle_request: keepalive
2025-01-29 18:37:27,591 WARNING StreamThr :319 [internal.py:is_dead():414] Internal process exiting, parent pid 286 disappeared
2025-01-29 18:37:27,591 ERROR   StreamThr :319 [internal.py:wandb_internal():152] Internal process shutdown.
2025-01-29 18:37:28,549 INFO    HandlerThread:319 [handler.py:finish():840] shutting down handler
2025-01-29 18:37:28,590 INFO    WriterThread:319 [datastore.py:close():294] close: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/run-9wi017uw.wandb
2025-01-29 18:37:35,507 INFO    SenderThread:319 [sender.py:send_artifact():1453] sent artifact job-https___github.com_cosmos1030_s2_multiencoder.git_combined_main.py - {'id': 'QXJ0aWZhY3Q6MTQ3NTAwMjQ0NQ==', 'state': 'COMMITTED', 'artifactSequence': {'id': 'QXJ0aWZhY3RDb2xsZWN0aW9uOjU1MjE3NTk3OQ==', 'latestArtifact': {'id': 'QXJ0aWZhY3Q6MTQ3NTAwMjQ0NQ==', 'versionIndex': 0}}}
2025-01-29 18:37:35,507 INFO    SenderThread:319 [sender.py:finish():1531] shutting down sender
2025-01-29 18:37:35,507 INFO    SenderThread:319 [dir_watcher.py:finish():358] shutting down directory watcher
2025-01-29 18:37:35,945 INFO    SenderThread:319 [dir_watcher.py:finish():388] scan: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files
2025-01-29 18:37:35,945 INFO    SenderThread:319 [dir_watcher.py:finish():402] scan save: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/requirements.txt requirements.txt
2025-01-29 18:37:35,945 INFO    SenderThread:319 [dir_watcher.py:finish():402] scan save: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/wandb-metadata.json wandb-metadata.json
2025-01-29 18:37:35,946 INFO    SenderThread:319 [dir_watcher.py:finish():402] scan save: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/wandb-summary.json wandb-summary.json
2025-01-29 18:37:35,946 INFO    SenderThread:319 [dir_watcher.py:finish():402] scan save: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/output.log output.log
2025-01-29 18:37:35,946 INFO    SenderThread:319 [dir_watcher.py:finish():402] scan save: /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/config.yaml config.yaml
2025-01-29 18:37:35,948 INFO    SenderThread:319 [file_pusher.py:finish():175] shutting down file pusher
2025-01-29 18:37:35,948 INFO    SenderThread:319 [file_pusher.py:join():181] waiting for file pusher
2025-01-29 18:37:36,137 INFO    wandb-upload_0:319 [upload_job.py:push():131] Uploaded file /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/requirements.txt
2025-01-29 18:37:36,858 INFO    wandb-upload_1:319 [upload_job.py:push():131] Uploaded file /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/wandb-summary.json
2025-01-29 18:37:37,374 INFO    wandb-upload_3:319 [upload_job.py:push():131] Uploaded file /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/config.yaml
2025-01-29 18:37:37,375 INFO    wandb-upload_2:319 [upload_job.py:push():131] Uploaded file /notebooks/s2_multiencoder/combined/wandb/run-20250129_183702-9wi017uw/files/output.log
2025-01-29 18:37:37,955 INFO    SenderThread:319 [file_stream.py:finish():594] file stream finish called
2025-01-29 18:37:38,169 INFO    SenderThread:319 [file_stream.py:finish():598] file stream finish is done
